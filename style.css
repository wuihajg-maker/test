body {
    font-family: 'Inter', sans-serif;
    touch-action: none;
    background-color: #fce4ec;
    padding: 1rem;
    overflow: hidden; 
    transition: background-image 0.8s ease-out, background-color 0.8s ease-out;
}

.cake-pattern-bg {
    background-image: url('stiker/pattern-ulang-tahun.png');
    background-repeat: repeat;
    background-size: 250px 250px;
}

.hidden { display: none !important; }
.font-caveat { font-family: 'Caveat', cursive; }

#container {
    width: 100%;
    max-width: 380px;
    margin: 2rem auto;
    text-align: center;
    padding: 0.5rem;
    position: relative;
    background-color: #ffffff;
    border-radius: 1.5rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    transition: opacity 0.8s ease-out;
}

#startScreen, #birthdayScreen {
    transition: opacity 0.5s ease-in-out;
}

.canvas-holder {
    position: relative;
    width: 300px;
    height: 380px;
    max-width: 100%;
    margin: 0.5rem auto 0;
    background-size: 100% 100%;
    background-repeat: no-repeat;
    background-position: center;
    background-image: url('stiker/kue-ultah.png'); 
    border-radius: 0.5rem;
    overflow: hidden;
}

#birthdayCanvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.animated-title { animation: bounceIn 1s ease-out forwards; }
@keyframes bounceIn {
    0% { opacity: 0; transform: scale(0.3); }
    50% { opacity: 1; transform: scale(1.1); }
    70% { transform: scale(0.9); }
    100% { opacity: 1; transform: scale(1); }
}

#confettiCanvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 999;
}

.gift-box {
    width: 200px;
    height: 200px;
    background: linear-gradient(135deg, #f06292 60%, #ffb6c1 100%);
    position: relative;
    border: 2px solid #fff;
    border-radius: 20px;
    box-shadow: 0 8px 24px rgba(240,98,146,0.3), 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
    cursor: pointer;
}
.gift-box:hover {
    transform: scale(1.1) rotate(-2deg);
    box-shadow: 0 16px 32px rgba(240,98,146,0.4), 0 4px 16px rgba(0,0,0,0.15);
}
.gift-lid {
    width: 200px;
    height: 32px;
    background: linear-gradient(90deg, #ec407a 70%, #fffde7 100%);
    position: absolute;
    top: -32px;
    left: 0;
    border-radius: 16px 16px 0 0;
    border: 2px solid #fff;
    box-shadow: 0 2px 8px rgba(236,64,122,0.2);
    z-index: 3;
}

.gift-tag {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: #fffde7;
    color: #ec407a;
    padding: 5px 15px;
    border-radius: 15px;
    font-family: 'Caveat', cursive;
    font-size: 1.2rem;
    font-weight: 700;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 4;
    animation: tag-pulse 2s infinite ease-in-out;
}
@keyframes tag-pulse {
    0%, 100% { transform: translateX(-50%) scale(1); }
    50% { transform: translateX(-50%) scale(1.05); }
}

.gift-box.clicked { animation: popEffect 0.4s ease-out; }
@keyframes popEffect {
    0% { transform: scale(1.1); }
    50% { transform: scale(0.95); }
    100% { transform: scale(1.1); }
}

.bear-head { position: absolute; top: -80px; left: 50%; transform: translateX(-50%); width: 80px; height: 80px; z-index: 10; }
.bear-face { position: absolute; top: 16px; left: 0; width: 80px; height: 64px; background: #fff8e1; border-radius: 50% 50% 45% 45% / 55% 55% 45% 45%; border: 2px solid #d7ccc8; }
.bear-ear { position: absolute; top: 0; width: 28px; height: 28px; background: #fff8e1; border-radius: 50%; border: 2px solid #d7ccc8; }
.bear-ear.left { left: -10px; } .bear-ear.right { right: -10px; }
.bear-eye { position: absolute; top: 32px; width: 8px; height: 8px; background: #6d4c41; border-radius: 50%; }
.bear-eye.left { left: 22px; } .bear-eye.right { right: 22px; }
.bear-nose { position: absolute; top: 44px; left: 36px; width: 8px; height: 6px; background: #6d4c41; border-radius: 60% 60% 80% 80%; }
.bear-mouth { position: absolute; top: 52px; left: 34px; width: 12px; height: 8px; border-bottom: 2px solid #6d4c41; border-radius: 0 0 12px 12px; }

.decorations { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }
.decorations > span { position: absolute; }
.decorations .star { color: #fffde7; text-shadow: 0 0 8px #f06292, 0 0 2px #fff; }
.decorations .star::before { content: "\2605"; }
.decorations .circle { width: 16px; height: 16px; border-radius: 50%; box-shadow: 0 0 8px #fffde7, 0 0 2px #f06292; }
.heart { width: 22px; height: 22px; background: transparent; }
.heart::before, .heart::after { content: ""; position: absolute; top: 0; left: 10px; width: 12px; height: 20px; background: #e57373; border-radius: 12px 12px 0 0; transform: rotate(-45deg); }
.heart::after { left: 0; transform: rotate(45deg); }
.decorations .star:nth-of-type(1) { top: 15px; left: 20px; font-size: 18px; animation: float1 8s ease-in-out infinite; }
.decorations .star:nth-of-type(2) { top: 25px; left: 160px; font-size: 14px; animation: float2 10s ease-in-out infinite; }
.decorations .star:nth-of-type(3) { top: 70px; left: 40px; font-size: 24px; animation: float3 12s ease-in-out infinite; }
.decorations .star:nth-of-type(4) { top: 80px; left: 150px; font-size: 18px; animation: float1 9s ease-in-out infinite 1s; }
.decorations .star:nth-of-type(5) { top: 120px; left: 15px; font-size: 16px; animation: float2 11s ease-in-out infinite; }
.decorations .star:nth-of-type(6) { top: 160px; left: 50px; font-size: 20px; animation: float3 8s ease-in-out infinite 0.5s; }
.decorations .star:nth-of-type(7) { top: 125px; left: 110px; font-size: 14px; animation: float1 13s ease-in-out infinite; }
.decorations .star:nth-of-type(8) { top: 170px; left: 165px; font-size: 18px; animation: float2 9s ease-in-out infinite 1.5s; }
@keyframes float1 { 0%,100%{transform:translate(0,0)rotate(-5deg)}50%{transform:translate(-5px,8px)rotate(5deg)} }
@keyframes float2 { 0%,100%{transform:translate(0,0)rotate(3deg)}50%{transform:translate(8px,-5px)rotate(-3deg)} }
@keyframes float3 { 0%,100%{transform:translate(0,0)rotate(0deg)}25%{transform:translate(5px,5px)rotate(5deg)}75%{transform:translate(-5px,-5px)rotate(-5deg)} }
.confetti { position: absolute; top: 50%; left: 50%; width: 95%; height: 95%; transform: translate(-50%, -50%); pointer-events: none; background: url('https://svgshare.com/i/14gG.svg') repeat; opacity: 0.5; z-index: 1; border-radius: 20px; }

.gallery-container { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; transition: opacity 0.4s ease-out; padding: 20px; box-sizing: border-box; }
.gallery-container.show { display: flex; opacity: 1; }
.gallery-content { position: relative; background: transparent; width: 100%; height: 100%; max-width: 1200px; max-height: 90vh; display: flex; justify-content: center; align-items: center; z-index: 2; opacity: 0; transform: scale(0.97) translateY(15px); transition: transform 0.4s ease-out, opacity 0.4s ease-out; }
.gallery-container.show .gallery-content { opacity: 1; transform: scale(1) translateY(0); }

.gallery-slide { display: none; opacity: 0; position: absolute; transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out; text-align: center; will-change: transform, opacity; max-width: 100%; max-height: 100%; display: flex; justify-content: center; align-items: center; }

.img-wrap { 
    position: relative; 
    border-radius: 14px; 
    overflow: hidden; 
    background-color: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(4px);
    box-shadow: 0 10px 36px rgba(0,0,0,0.25); 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    max-width: 85vmin; 
    max-height: 85vmin; 
    aspect-ratio: auto; 
}
.gallery-slide img { width: auto; height: auto; max-width: 100%; max-height: 100%; object-fit: contain; display: block; min-width: 0; min-height: 0; }
.gallery-slide.active { opacity: 1; transform: scale(1); z-index: 2; }
.gallery-slide.left, .gallery-slide.right { opacity: 0; pointer-events: none; z-index: 1; filter: blur(3px); transform: scale(0.8); }

.prev, .next { position: absolute; top: 50%; transform: translateY(-50%); font-size: 28px; color: #333; background: rgba(255,255,255,0.85); border-radius: 50%; width: 52px; height: 52px; line-height: 52px; text-align: center; cursor: pointer; user-select: none; z-index: 60; box-shadow: 0 4px 15px rgba(0,0,0,0.15); transition: transform 0.2s, background-color 0.2s; }
.prev:hover, .next:hover { transform: translateY(-50%) scale(1.1); background: #fff; }
.prev { left: 30px; }
.next { right: 30px; }
.close-button { position: absolute; top: 20px; right: 20px; font-size: 32px; color: #fff; background: rgba(0,0,0,0.4); border-radius: 50%; width: 44px; height: 44px; line-height: 44px; text-align: center; cursor: pointer; z-index: 100; }

#confetti-rain-bg { 
    position: absolute; 
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%; 
    z-index: 1; 
    pointer-events: none; 
    overflow: hidden; 
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 500'%3E%3Crect x='15' y='45' width='4' height='25' fill='%23f06292' transform='rotate(15 17 57.5)'/%3E%3Crect x='45' y='120' width='3' height='20' fill='%23fffde7' transform='rotate(-25 46.5 130)'/%3E%3Crect x='90' y='60' width='5' height='18' fill='%2381d4fa' transform='rotate(45 92.5 69)'/%3E%3Crect x='120' y='220' width='4' height='25' fill='%23a5d6a7' transform='rotate(-10 122 232.5)'/%3E%3Crect x='150' y='150' width='3' height='20' fill='%23ffd54f' transform='rotate(20 151.5 160)'/%3E%3Crect x='180' y='90' width='5' height='18' fill='%23ce93d8' transform='rotate(-40 182.5 99)'/%3E%3Crect x='210' y='300' width='4' height='25' fill='%23f06292' transform='rotate(10 212 312.5)'/%3E%3Crect x='240' y='180' width='3' height='20' fill='%23fffde7' transform='rotate(30 241.5 190)'/%3E%3Crect x='270' y='400' width='5' height='18' fill='%2381d4fa' transform='rotate(-15 272.5 409)'/%3E%3Crect x='30' y='450' width='4' height='25' fill='%23a5d6a7' transform='rotate(25 32 462.5)'/%3E%3Crect x='100' y='350' width='3' height='20' fill='%23ffd54f' transform='rotate(-5 101.5 360)'/%3E%3Crect x='200' y='250' width='5' height='18' fill='%23ce93d8' transform='rotate(50 202.5 259)'/%3E%3Crect x='60' y='280' width='4' height='25' fill='%23f06292' transform='rotate(-12 62 292.5)'/%3E%3Crect x='130' y='20' width='3' height='20' fill='%23fffde7' transform='rotate(18 131.5 30)'/%3E%3Crect x='250' y='30' width='5' height='18' fill='%2381d4fa' transform='rotate(-33 252.5 39)'/%3E%3Crect x='280' y='320' width='4' height='25' fill='%23a5d6a7' transform='rotate(5 282 332.5)'/%3E%3C/svg%3E"); 
    background-size: 300px; 
    animation: rain 9s linear infinite; 
    opacity: 0.7;
    mix-blend-mode: soft-light;
}
@keyframes rain { from { background-position: 0 0; } to { background-position: 0 500px; } }

#letter-container, #poem-container { 
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    display: none; justify-content: center; align-items: center; z-index: 90; 
    opacity: 0; transform: scale(0.9); transition: opacity 0.5s ease-out, transform 0.5s ease-out; 
}
#letter-container.show, #poem-container.show { opacity: 1; transform: scale(1); }
.letter-paper { background: #fffef5; padding: 30px 40px; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); max-width: 500px; width: 90%; text-align: center; font-family: 'Playpen Sans', cursive; color: #5d4037; }
.letter-paper h2 { font-size: 1.6em; font-weight: 400; margin-bottom: 10px; margin-top: 10px; color: #e91e63; }
.letter-paper p { font-size: 1.1em; line-height: 1.6; font-weight: 300; }
.letter-button { margin-top: 25px; padding: 10px 20px; border: none; background: #f06292; color: white; font-family: sans-serif; font-size: 1em; border-radius: 20px; cursor: pointer; transition: background-color 0.3s, transform 0.3s; }
.letter-button:hover { background: #ec407a; transform: scale(1.05); }
.gallery-content.letter-mode .gallery-slide, .gallery-content.letter-mode .prev, .gallery-content.letter-mode .next { display: none !important; }
.gallery-content.poem-mode .gallery-slide, .gallery-content.poem-mode .prev, .gallery-content.poem-mode .next { display: none !important; }

.final-slide-indicator { position: absolute; bottom: 20px; right: 20px; width: 50px; height: 50px; background: rgba(240, 98, 146, 0.8); border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 0 15px rgba(240, 98, 146, 0.7); transform: scale(0); opacity: 0; transition: transform 0.4s 0.5s, opacity 0.4s 0.5s; }
.gallery-slide.active .final-slide-indicator { transform: scale(1); opacity: 1; animation: pulse 2s infinite; }
.final-slide-indicator svg { width: 28px; height: 28px; color: white; }
@keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 15px rgba(240, 98, 146, 0.7); } 50% { transform: scale(1.1); box-shadow: 0 0 25px rgba(240, 98, 146, 1); } 100% { transform: scale(1); box-shadow: 0 0 15px rgba(240, 98, 146, 0.7); } }

.typing-text { min-height: 1.6em; white-space: pre-wrap; }
.typing-text.typing::after { content: '|'; color: #e91e63; animation: blink 1s step-end infinite; }
@keyframes blink { from, to { opacity: 1; } 50% { opacity: 0; } }

#poem-placeholder { min-height: 150px; text-align: left; }
.loader {
    width: 48px;
    height: 48px;
    border: 5px solid #e91e63;
    border-bottom-color: transparent;
    border-radius: 50%;
    display: inline-block;
    box-sizing: border-box;
    animation: rotation 1s linear infinite;
    margin: 20px auto;
}
@keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }


@media (max-width: 768px) {
    .prev, .next { width: 44px; height: 44px; line-height: 44px; font-size: 22px; left: 15px; right: 15px; }
    .close-button { top: 15px; right: 15px; }
    .img-wrap { max-width: 90vmin; max-height: 90vmin; }
}
@media (max-height: 500px) and (orientation: landscape) {
    .gift-box { width: 150px; height: 150px; }
    .bear-head { transform: translateX(-50%) scale(0.8); top: -64px; }
    .gallery-content { max-height: 95vh; padding-top: 45px; box-sizing: border-box; }
    .prev, .next { left: 25px; right: 25px; }
    .img-wrap { max-width: 80vmin; max-height: 80vmin; }
}
@media (max-width: 480px) {
    .letter-paper { padding: 20px 25px; }
    .letter-paper h2 { font-size: 1.4em; margin-bottom: 8px; margin-top: 8px; }
    .letter-paper p { font-size: 1em; }
    .img-wrap { max-width: 95vmin; max-height: 95vmin; }
}
@media (max-width: 380px) {
    .gift-box { width: 180px; height: 180px; }
    .prev, .next { width: 38px; height: 38px; line-height: 38px; font-size: 18px; left: 8px; right: 8px; }
    .close-button { top: 8px; right: 8px; width: 38px; height: 38px; line-height: 38px; }
}

